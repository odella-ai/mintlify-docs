---
title: "DOCX Template"
description: "Learn how to create and configure DOCX templates with Mustache-like syntax and AI-powered field detection for automated document generation"
---

 

## Create Your First DOCX Template

DOCX templates in Odella are perfect for dynamic document creation with flexible layouts. Using Mustache-like syntax, you can create powerful templates for contracts, letters, and general legal documents that require substantial content variation and intelligent automation.

<Callout type="info" emoji="ðŸ“„">
  DOCX templates work best with documents that require dynamic content, such as contracts, letters, and legal documents where layout can adapt to varying content lengths.
</Callout>

## Step-by-Step Template Creation

<Steps>
  <Step title="Upload Your DOCX Document">
    Start by uploading your Word document to Odella. Navigate to the Templates section and click "Create New Template," then select "DOCX Template" and upload your file. Ensure your document is properly formatted and contains the content structure you want to template.
  </Step>
  
  <Step title="Name and Describe Your Template">
    Give your template a clear, descriptive name and detailed description. This is crucial - your AI employees use this information to determine which template to use in different contexts. Be specific about the document's purpose, when it should be used, and any special requirements.
  </Step>
  
  <Step title="Edit Document with Mustache Syntax">
    Enter the template drafting editor where you can modify your document using Mustache syntax to define variables, conditions, loops, equations, and formatting. The syntax uses double curly braces `{{ }}` as delimiters and allows you to create dynamic content that adapts based on data inputs while maintaining document structure and formatting.
  </Step>
  
  <Step title="Sync Template Fields">
    After templating your document with Mustache syntax, click "Sync Document" to sync the template fields with the template system. Our AI automatically detects all template variables and generates intelligent instructions for how to fill each field, including data type detection and contextual filling guidance. The system analyzes variable names, surrounding context, and document structure to create appropriate filling instructions.
  </Step>
  
  <Step title="Review and Configure Field Instructions">
    Review all detected template fields and their auto-generated instructions. You can adjust the prompts to change the tone, set default values, and modify drafting instructions based on your specific requirements. Each field displays its type, current instruction, and preview of how it will be populated. Fine-tune these instructions to ensure the AI understands exactly how to fill each field according to your legal standards and formatting preferences.
  </Step>
  
  <Step title="Save and Publish">
    When you're finished configuring all fields and instructions, save and publish your template. The template is now available for use and can be attached directly to an AI employee or integrated into workflows for automated document generation.
  </Step>
</Steps>

## Template Syntax Reference

### Variables

Insert dynamic values into your template using variable syntax.

#### Basic Variables

**Syntax:** `{{ variable_name }}`

Simple variable interpolation replaces the placeholder with the actual value from your data. Variable names should be descriptive and match the data field exactly. Variables are case-sensitive and can include underscores but should avoid spaces.

**Example:** `{{ client_name }}`, `{{ contract_date }}`

#### Transform Pipes

**Syntax:** `{{ variable_name | formatter }}` or `{{ variable_name | formatter(arg1, arg2) }}`

Post-process variables with formatters for text transformation, currency formatting, or image embedding. Chain multiple pipes with additional `|` operators.

**Available Pipes:**
- `lowercase` - Converts text to lowercase
- `uppercase` - Converts text to uppercase
- `capitalize` - Capitalizes the first letter of each word
- `currency(currencyISO, fractionDigits, locale)` - Formats as currency (default: USD, 0 decimals, en locale)
- `image(width, height)` - Embeds an image from URL with specified dimensions

**Example:** `{{ amount | currency(USD, 2) }}`, `{{ name | capitalize }}`

### Conditionals

Control which content appears based on conditions.

#### Simple Conditionals

**Syntax:** `{{ ? condition }} content {{ / condition }}`

Conditional sections that only display content when the condition evaluates to true. Perfect for showing different clauses based on client type, agreement terms, or other binary decisions.

**Example:** `{{ ? is_corporate }} This is a corporate agreement {{ / is_corporate }}`

#### Inverted Conditionals

**Syntax:** `{{ ^ condition }} content {{ / condition }}`

Shows content when a condition is false. This is shorthand for `{{ if not condition }}`.

**Example:** `{{ ^ is_premium_client }} Standard terms apply {{ / is_premium_client }}`

#### If/Else Branching

**Syntax:** `{{ if condition }} ... {{ else if condition_b }} ... {{ else }} ... {{ /endif }}`

Multi-branch conditional sections with explicit if/else if/else logic. Note that `{{ ? condition }}` is shorthand for `{{ if condition }}` and `{{ ^ condition }}` is shorthand for `{{ if not condition }}`. Close blocks with `{{ /endif }}`.

**Example:** `{{ if is_corporate }}Corporate{{ else if is_nonprofit }}Nonprofit{{ else }}Individual{{ /endif }}`

### Loops

Iterate through lists and arrays to generate repeating content.

**Syntax:** `{{ # items }} {{ item_value }} {{ / items }}`

Iteration blocks that repeat content for each item in a list or array. The opening tag `{{ # items }}` starts the loop, and the closing tag `{{ / items }}` ends it. Everything between these tags will be repeated for each item in the collection. Inside the loop, you can access properties of each item directly.

**Example:** `{{ # witnesses }} {{ name }}, {{ title }} {{ / witnesses }}`

**Special Variables:**
- `{{ loop_index }}` - Provides automatic numbering starting from 1

### Equations

Compute values inline using arithmetic and function expressions.

**Syntax:** `{{= expression }}`

Evaluates arithmetic or function expressions. Reference variables using bracket notation `[variable_name]`. Basic arithmetic operators (`+`, `-`, `*`, `/`, `%`, `^`) and parentheses are supported.

**Example:** `{{= 1 + 1 }}`, `{{= SUM([amounts]) }}`, `{{= ROUND([amount] * [tax_rate], 2) }}`

<Callout type="info" emoji="ðŸ§®">
  Variables in equations must be wrapped in square brackets: `[amount]`, `[tax_rate]`, `[prices]`.
</Callout>

#### Supported Equation Functions

##### Aggregation Functions

- **SUM(...numbers)** - Adds all numbers. Example: `{{=SUM([prices])}}`
- **AVERAGE(...numbers)** - Returns arithmetic mean. Example: `{{=AVERAGE([scores])}}`
- **COUNT(...values)** - Counts numbers in arguments. Example: `{{=COUNT([items])}}`
- **MAX(...numbers)** - Returns largest value. Example: `{{=MAX([prices])}}`
- **MIN(...numbers)** - Returns smallest value. Example: `{{=MIN([prices])}}`
- **SUMPRODUCT(...arrays)** - Multiplies corresponding array components and sums. Example: `{{=SUMPRODUCT([quantities], [prices])}}`
- **PRODUCT(...numbers)** - Multiplies all numbers. Example: `{{=PRODUCT([width], [height], [depth])}}`

##### Rounding Functions

- **ROUND(number, digits)** - Rounds to specified digits (default 0). Example: `{{=ROUND([amount], 2)}}`
- **CEILING(number, significance)** - Rounds up to nearest multiple (default 1). Example: `{{=CEILING([amount], 5)}}`
- **FLOOR(number, significance)** - Rounds down to nearest multiple (default 1). Example: `{{=FLOOR([amount], 5)}}`

##### Math Functions

- **ABS(number)** - Returns absolute value. Example: `{{=ABS([balance])}}`
- **SQRT(number)** - Returns square root. Example: `{{=SQRT([area])}}`
- **POWER(number, power)** - Raises to power. Example: `{{=POWER([base], 2)}}`
- **MOD(number, divisor)** - Returns remainder from division. Example: `{{=MOD([total], 10)}}`

##### Text Functions

- **CONCATENATE(...text)** - Joins text strings. Example: `{{=CONCATENATE([first_name], " ", [last_name])}}`
- **LEFT(text, numChars)** - Returns first N characters (default 1). Example: `{{=LEFT([code], 3)}}`
- **RIGHT(text, numChars)** - Returns last N characters (default 1). Example: `{{=RIGHT([code], 4)}}`
- **LEN(text)** - Returns string length. Example: `{{=LEN([description])}}`
- **UPPER(text)** - Converts to uppercase. Example: `{{=UPPER([name])}}`
- **LOWER(text)** - Converts to lowercase. Example: `{{=LOWER([email])}}`

##### Logical Functions

- **IF(condition, trueValue, falseValue)** - Returns value based on condition. Example: `{{=IF([is_premium], [price] * 0.9, [price])}}`

### Comments

**Syntax:** `{{! comment text }}`

Comment blocks that are ignored during template processing and won't appear in the final document. Use these for documentation, notes to other template editors, or temporary removal of content.

**Example:** `{{! This section handles payment terms }}`

## Advanced Template Configuration

<CardGroup cols={2}>
  <Card title="Variable Types" icon="pen-to-square">
    Configure different data types for variables including text, dates, numbers, and boolean values. Set formatting requirements and validation rules for each variable type.
  </Card>
  <Card title="Conditional Logic" icon="code-branch">
    Create smart conditional sections that show or hide content based on data values, such as different clauses for different contract types or client categories.
  </Card>
  <Card title="Dynamic Lists" icon="list">
    Use loop syntax to handle dynamic lists of items like witnesses, terms, payment schedules, or any repeating data structures in your documents.
  </Card>
  <Card title="Default Values" icon="shield-check">
    Set intelligent default values for common fields and define fallback content when optional data is not provided.
  </Card>
</CardGroup>

## Best Practices

<Steps>
  <Step title="Descriptive Variable Names">
    Use clear, descriptive variable names like `{{ client_full_legal_name }}` rather than generic names like `{{ name1 }}`. This helps with AI understanding and template maintenance. Consider using naming conventions like `entity_type`, `agreement_date`, `billing_address_line1` to create consistency across your templates.
  </Step>
  
  <Step title="Logical Content Structure">
    Organize your template with logical sections and use comments to document complex conditional logic or loops for future reference and maintenance. Group related variables together and use whitespace effectively to make your template code readable.
  </Step>
  
  <Step title="Comprehensive Field Instructions">
    Provide detailed instructions for each template field, including formatting requirements, tone preferences, and any special considerations for AI population. Specify whether fields should be formal or casual, how dates should be formatted, and any legal language requirements.
  </Step>
  
  <Step title="Regular Testing">
    Test your templates with sample data to ensure all variables, conditions, and loops work correctly before publishing to production use. Test edge cases like empty lists, missing optional fields, and different data combinations to ensure robust template behavior.
  </Step>
</Steps>

## Using Your DOCX Template

Once published, your DOCX template can be used in two main ways:

<CardGroup cols={2}>
  <Card title="AI Employee Integration" icon="robot">
    Attach the template directly to an AI employee to enable automatic document generation as part of their capabilities. The AI employee can then generate documents using this template when needed, automatically populating all variables based on available data and context.
  </Card>
  <Card title="Workflow Integration" icon="diagram-project">
    Integrate the template into your custom workflows using the "Populate Template" block, enabling automated document generation at any stage of your business processes. Templates can be triggered by specific events, data changes, or user actions within your workflows.
  </Card>
</CardGroup>

<Callout type="info" emoji="ðŸ“–">
  For detailed instructions on how to use your published templates with AI employees and workflows, see our [Using Templates](/templates/04_using-templates) guide.
</Callout>

## Template Examples

<Callout type="tip" emoji="ðŸ’¡">
  Below are real-world template patterns with detailed explanations to help you build sophisticated documents.
</Callout>

### Variable Examples

#### Simple Variable Insertion

```
Dear {{ client_name }},
```

This replaces `{{ client_name }}` with the actual client's name from your data. The variable name should exactly match the field name in your data source.

#### Transform Pipe Examples

**Basic Text Formatting:**
```
Company: {{ company_name | uppercase }}
Email: {{ email | lowercase }}
Client Name: {{ full_name | capitalize }}
```

**Currency Formatting:**
```
Total: {{ amount | currency(USD, 2, en) }}
Price: {{ price | currency(EUR, 2, de) }}
Balance: {{ balance | currency(GBP, 0, en-GB) }}
```

**Chaining Multiple Pipes:**
```
{{ company_name | lowercase | capitalize }}
```
This first converts to lowercase, then capitalizes each word.

**Image Embedding:**
```
{{ company_logo | image(300, 150) }}
```
Embeds the image at 300px width and 150px height.

### Conditional Examples

#### Simple Conditional Logic

```
{{ ? is_individual }} 
acting in their individual capacity 
{{ / is_individual }}
{{ ? is_corporate }} 
acting through its duly authorized representatives 
{{ / is_corporate }}
```

This creates mutually exclusive content blocks. Only one section will appear based on the client type.

#### If/Else/Else If Chain

```
{{ if is_individual }}
acting in their individual capacity
{{ else if is_corporate }}
acting through its duly authorized representatives
{{ else }}
acting as applicable
{{ /endif }}
```

Equivalent branching using explicit if/else if/else with a closing `{{ /endif }}`.

#### Inverted Conditions

```
{{ ^ is_premium_client }}
Standard terms and conditions apply.
{{ / is_premium_client }}
```

This content only appears for non-premium clients.

#### Conditional Formatting

```
Total Amount: {{ ? currency_symbol }}{{ currency_symbol }}{{ / currency_symbol }}{{ amount }}{{ ? is_estimate }} (estimated){{ / is_estimate }}
```

This shows how to conditionally include formatting elements like currency symbols and qualifiers.

### Loop Examples

#### Simple List Iteration

```
Witnesses:
{{ # witnesses }}
{{ loop_index }}. {{ name }} ({{ title }}){{ ? address }}, residing at {{ address }}{{ / address }}
{{ / witnesses }}
```

This creates a numbered list of witnesses with optional address information. The `loop_index` provides automatic numbering.

#### Nested Conditional Lists

```
{{ ? has_attachments }}
Attachments:
{{ # attachments }}
- {{ filename }}{{ ? description }}: {{ description }}{{ / description }}
{{ / attachments }}
{{ / has_attachments }}
```

This shows how to combine conditionals with loops - only showing the attachments section if attachments exist.

### Equation Examples

#### Basic Equations

```
{{=1 + 1}}
{{=SUM([line_items])}}
{{=ROUND([amount] * [tax_rate], 2)}}
{{=IF([is_discounted], [amount] * 0.9, [amount])}}
{{=CONCATENATE("Total: $", ROUND(SUM([prices]), 2))}}
{{=SUMPRODUCT([quantities], [unit_prices])}}
{{=AVERAGE([scores]) * 100}}
```

#### Loops with Equations

You can combine loops with equations to display lists and calculate totals. Use dot notation `[array.property]` to access nested properties within arrays when using equations:

```
Assets:
{{#assets}}
Item {{idx}}: {{value}}
{{/assets}}

Total Asset Value: {{=SUM([assets.value])}}
```

This example loops through an `assets` array to display each item, then uses `{{=SUM([assets.value])}}` to calculate the total of all `value` properties in the array.

#### Complex Invoice Example

```
Line Items:
{{#line_items}}
- {{description}}: ${{price}} x {{quantity}} = ${{=ROUND([price] * [quantity], 2)}}
{{/line_items}}

Subtotal: ${{=SUM([line_items.total])}}
Tax ({{tax_rate}}%): ${{=ROUND(SUM([line_items.total]) * [tax_rate] / 100, 2)}}
Grand Total: ${{=ROUND(SUM([line_items.total]) * (1 + [tax_rate] / 100), 2)}}
```

<Callout type="tip" emoji="ðŸ’¡">
  Equations can be nested and combined. For example: `{{=ROUND(SUM([amounts]) * [tax_rate], 2)}}` calculates the sum of amounts, multiplies by tax rate, and rounds to 2 decimal places.
</Callout>

### Comment Examples

```
{{! Payment terms section - modify based on client credit rating }}
Payment Terms: {{ payment_terms }}
{{! TODO: Add late fee calculation formula }}
```

Use comments to document business logic, remind about future updates, or explain complex template sections to other team members.

<Callout type="warning" emoji="âš–ï¸">
  Always review your DOCX templates thoroughly before publishing them. Test all template variables, conditions, and loops to ensure they work correctly and produce the expected output. Pay special attention to conditional logic to ensure all possible data combinations produce valid documents.
</Callout>

Ready to create your first DOCX template? Follow these steps to transform your static documents into intelligent, AI-powered document generation tools with dynamic content capabilities!
